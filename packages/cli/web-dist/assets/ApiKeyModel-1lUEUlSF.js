import{j as e}from"./vendor-markdown-BqRWHW3K.js";import{r as h}from"./vendor-react-C5jCz3x-.js";import{u as A,b as f}from"./vendor-utils-qCXT5GGb.js";import{s as L,d as S,g as K,a as I,O as P,D,V as E}from"./index-VqrY-VuW.js";import"./vendor-ui-C70-qNWB.js";import"./vendor-monaco-nD5yPjNo.js";const M=({platform:a,className:i="w-5 h-5"})=>{const o={doubao:e.jsx("img",{src:E,alt:"火山方舟",className:i}),deepseek:e.jsx("img",{src:D,alt:"DeepSeek",className:i}),openai:e.jsx("img",{src:P,alt:"OpenAI",className:i}),siliconflow:e.jsx("img",{src:"https://cloud.siliconflow.cn/favicon.ico",alt:"硅基流动",className:i})};return e.jsx(e.Fragment,{children:o[a]})},C=[{key:"siliconflow",name:"硅基流动",url:"https://cloud.siliconflow.cn/"},{key:"deepseek",name:"DeepSeek",url:"https://platform.deepseek.com/"},{key:"openai",name:"OpenAI",url:"https://platform.openai.com/"},{key:"doubao",name:"火山方舟（豆包）",url:"https://console.volcengine.com/ark"}];function W(a){return a.length<=8?"****":`${a.slice(0,4)}...${a.slice(-4)}`}function V({platform:a,name:i,url:o,apiKey:u,onSave:b,onDelete:w}){const[c,m]=h.useState(!1),[l,y]=h.useState(!1),[d,p]=h.useState(""),[g,j]=h.useState(!1),[v,s]=h.useState(!1),r=!!u,n=async()=>{if(!d.trim()){f.error("请输入 API Key");return}j(!0);try{await b(d.trim()),p(""),m(!1)}finally{j(!1)}},t=async()=>{s(!0);try{await w()}finally{s(!1)}},N=()=>{m(!1),p("")};return e.jsxs("div",{className:"p-4 bg-[#0d1117] rounded-lg border border-[#30363d]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{platform:a}),e.jsx("span",{className:"font-medium text-[#f0f6fc]",children:i}),r&&!c?e.jsx("span",{className:"text-xs text-emerald-400",children:"✓ 已配置"}):e.jsx("span",{className:"text-xs text-[#8b949e]",children:"未配置"})]}),e.jsx("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-[#58a6ff] hover:underline",children:"获取 API Key →"})]}),e.jsx("div",{className:"h-10",children:r&&!c?e.jsxs("div",{className:"flex items-center gap-3 h-full",children:[e.jsx("div",{className:"flex-1 px-3 h-full flex items-center bg-[#161b22] border border-[#30363d] rounded-lg font-mono text-sm text-[#8b949e] overflow-x-auto cursor-not-allowed opacity-70 hover:opacity-60 transition-opacity",children:e.jsx("span",{className:"whitespace-nowrap",children:l?u:W(u)})}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsx("button",{onClick:()=>y(!l),className:"w-8 h-8 flex items-center justify-center rounded-lg text-[#8b949e] hover:text-[#f0f6fc] hover:bg-[#21262d] transition-colors",title:l?"隐藏":"显示",children:l?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),e.jsx("button",{onClick:()=>m(!0),className:"w-8 h-8 flex items-center justify-center rounded-lg text-[#8b949e] hover:text-[#f0f6fc] hover:bg-[#21262d] transition-colors",title:"编辑",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:t,disabled:v,className:"w-8 h-8 flex items-center justify-center rounded-lg text-[#8b949e] hover:text-[#f85149] hover:bg-[#f85149]/10 transition-colors disabled:opacity-50",title:"删除",children:v?e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}):e.jsxs("div",{className:"flex gap-2 h-full",children:[e.jsx("input",{type:"password",value:d,onChange:x=>p(x.target.value),onKeyDown:x=>{x.key==="Enter"&&d.trim()&&n(),x.key==="Escape"&&N()},placeholder:"请输入 API Key",autoFocus:c,className:"flex-1 px-3 h-full bg-[#161b22] border border-[#30363d] rounded-lg text-[#f0f6fc] placeholder-[#484f58] focus:outline-none focus:border-[#58a6ff]"}),e.jsx("button",{onClick:n,disabled:g||!d.trim(),className:`
                px-4 h-full rounded-lg font-medium text-sm transition-all duration-200 shrink-0
                ${g||!d.trim()?"bg-[#21262d] text-[#484f58] cursor-not-allowed":"bg-[#238636] text-white hover:bg-[#2ea043]"}
              `,children:g?"保存中...":"保存"}),c&&e.jsx("button",{onClick:N,className:"px-4 h-full rounded-lg font-medium text-sm transition-all duration-200 bg-[#21262d] text-[#8b949e] hover:text-[#f0f6fc] hover:bg-[#30363d]",children:"取消"})]})})]})}function R(){const[a,i]=h.useState(null),{data:o,loading:u}=A(K),{data:b,loading:w,refresh:c}=A(I),m=(o==null?void 0:o.models)||[],l=b||{defaultModel:null,apiKeys:{siliconflow:null,deepseek:null,openai:null,doubao:null}},y=(u||w)&&!o&&!b,d=s=>s.startsWith("siliconflow/")?"siliconflow":s.startsWith("deepseek/")?"deepseek":s.startsWith("doubao/")?"doubao":"openai",p=s=>!!l.apiKeys[s],g=async(s,r)=>{var n;try{await L({apiKeys:{[s]:r}}),await c(),f.success(`${(n=C.find(t=>t.key===s))==null?void 0:n.name} API Key 保存成功`)}catch(t){throw f.error(t instanceof Error?t.message:"保存失败"),t}},j=async s=>{var r;try{await S(s),await c(),f.success(`${(r=C.find(n=>n.key===s))==null?void 0:r.name} API Key 已删除`)}catch(n){throw f.error(n instanceof Error?n.message:"删除失败"),n}},v=async s=>{var n;if(s===l.defaultModel)return;const r=((n=m.find(t=>t.id===s))==null?void 0:n.name)||s;i(s);try{await L({defaultModel:s}),await c(),f.success(`默认模型已切换到: ${r}`)}catch(t){f.error(t instanceof Error?t.message:"切换失败")}finally{i(null)}};return y?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx("div",{className:"text-[#8b949e]",children:"加载中..."})}):e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("header",{className:"h-14 flex items-center px-6 bg-[#161b22] border-b border-[#30363d] shrink-0",children:e.jsx("h2",{className:"text-lg font-semibold text-[#f0f6fc]",children:"模型与 API Key"})}),e.jsx("main",{className:"flex-1 overflow-auto p-6",children:e.jsxs("div",{className:"max-w-3xl space-y-8",children:[e.jsxs("section",{className:"bg-[#161b22] rounded-lg border border-[#30363d] p-6",children:[e.jsx("h3",{className:"text-base font-semibold text-[#f0f6fc] mb-2",children:"API Keys"}),e.jsx("p",{className:"text-sm text-[#8b949e] mb-6",children:"配置各平台的 API Key 以启用对应的模型。"}),e.jsx("div",{className:"space-y-4",children:C.map(({key:s,name:r,url:n})=>e.jsx(V,{platform:s,name:r,url:n,apiKey:l.apiKeys[s],onSave:t=>g(s,t),onDelete:()=>j(s)},s))})]}),e.jsxs("section",{className:"bg-[#161b22] rounded-lg border border-[#30363d] p-6",children:[e.jsx("h3",{className:"text-base font-semibold text-[#f0f6fc] mb-2",children:"默认模型"}),e.jsx("p",{className:"text-sm text-[#8b949e] mb-6",children:"点击选择生成周报时使用的默认模型，选择后立即生效。"}),e.jsx("div",{className:"space-y-6",children:["doubao","deepseek","openai","siliconflow"].map(s=>{const r=m.filter(t=>d(t.id)===s);if(r.length===0)return null;const n={doubao:"火山方舟（豆包）",deepseek:"DeepSeek",openai:"OpenAI",siliconflow:"硅基流动（免费）"};return e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-[#8b949e] mb-3 flex items-center gap-2",children:[e.jsx(M,{platform:s,className:"w-4 h-4"}),e.jsx("span",{children:n[s]})]}),e.jsx("div",{className:"grid gap-3",children:r.map(t=>{const N=p(s),x=l.defaultModel===t.id,k=a===t.id;return e.jsxs("button",{onClick:()=>v(t.id),disabled:k||x,className:`
                              w-full p-4 rounded-lg border text-left transition-all duration-200 relative
                              ${x?"bg-blue-500/10 border-blue-500/50":"bg-[#0d1117] border-[#30363d] hover:border-[#484f58]"}
                              ${k?"opacity-70":""}
                            `,children:[k&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#0d1117]/50 rounded-lg",children:e.jsx("span",{className:"text-sm text-[#8b949e]",children:"切换中..."})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-[#f0f6fc] flex items-center gap-2",children:[t.name,t.isFree&&e.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-400",children:"免费"}),x&&e.jsx("span",{className:"text-xs text-blue-400",children:"● 当前默认"})]}),e.jsx("div",{className:"text-sm text-[#8b949e] mt-1",children:t.description}),e.jsx("div",{className:"text-xs text-[#484f58] mt-1",children:t.id})]}),e.jsx("div",{className:"text-right",children:N?e.jsx("span",{className:"text-xs text-emerald-400",children:"可用"}):e.jsx("span",{className:"text-xs text-yellow-400",children:"需配置 Key"})})]})]},t.id)})})]},s)})})]})]})})]})}export{R as default};
