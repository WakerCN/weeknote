import{j as e}from"./vendor-markdown-BqRWHW3K.js";import{r as d}from"./vendor-react-C5jCz3x-.js";import{u as W,b as l}from"./vendor-utils-DsccwzuD.js";import{s as L,d as H,g as O,a as F,O as R,D as _,V as q}from"./index-DvHGrkk7.js";import"./vendor-ui-T82k-wTi.js";import"./vendor-monaco-nD5yPjNo.js";const $=({platform:i,className:o="w-5 h-5"})=>{const x={doubao:e.jsx("img",{src:q,alt:"火山方舟",className:o}),deepseek:e.jsx("img",{src:_,alt:"DeepSeek",className:o}),openai:e.jsx("img",{src:R,alt:"OpenAI",className:o}),siliconflow:e.jsx("img",{src:"https://cloud.siliconflow.cn/favicon.ico",alt:"硅基流动",className:o})};return e.jsx(e.Fragment,{children:x[i]})},A=[{key:"siliconflow",name:"硅基流动",url:"https://cloud.siliconflow.cn/"},{key:"deepseek",name:"DeepSeek",url:"https://platform.deepseek.com/"},{key:"openai",name:"OpenAI",url:"https://platform.openai.com/"},{key:"doubao",name:"火山方舟（豆包）",url:"https://console.volcengine.com/ark"}];function T(i){return i.length<=8?"****":`${i.slice(0,4)}...${i.slice(-4)}`}function G({platform:i,name:o,url:x,apiKey:g,endpointId:j,onSave:C,onDelete:p,onSaveEndpoint:v}){const[r,N]=d.useState(!1),[b,E]=d.useState(!1),[f,w]=d.useState(""),[y,k]=d.useState(!1),[s,a]=d.useState(!1),[n,t]=d.useState(!1),[u,h]=d.useState(""),[m,M]=d.useState(!1),S=!!g,z=i==="doubao",I=!!j,D=async()=>{if(!f.trim()){l.error("请输入 API Key");return}k(!0);try{await C(f.trim()),w(""),N(!1)}finally{k(!1)}},B=async()=>{a(!0);try{await p()}finally{a(!1)}},K=()=>{N(!1),w("")},P=async()=>{if(!u.trim()){l.error("请输入接入点 ID");return}if(v){M(!0);try{await v(u.trim()),h(""),t(!1)}finally{M(!1)}}},V=()=>{t(!1),h("")};return e.jsxs("div",{className:"p-4 bg-[#0d1117] rounded-lg border border-[#30363d]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{platform:i}),e.jsx("span",{className:"font-medium text-[#f0f6fc]",children:o}),S&&!r?e.jsx("span",{className:"text-xs text-emerald-400",children:"✓ 已配置"}):e.jsx("span",{className:"text-xs text-[#8b949e]",children:"未配置"})]}),e.jsx("a",{href:x,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-[#58a6ff] hover:underline",children:"获取 API Key →"})]}),e.jsx("div",{className:"h-10",children:S&&!r?e.jsxs("div",{className:"flex items-center gap-3 h-full",children:[e.jsx("div",{className:"flex-1 px-3 h-full flex items-center bg-[#161b22] border border-[#30363d] rounded-lg font-mono text-sm text-[#8b949e] overflow-x-auto cursor-not-allowed opacity-70 hover:opacity-60 transition-opacity",children:e.jsx("span",{className:"whitespace-nowrap",children:b?g:T(g)})}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsx("button",{onClick:()=>E(!b),className:"w-8 h-8 flex items-center justify-center rounded-lg text-[#8b949e] hover:text-[#f0f6fc] hover:bg-[#21262d] transition-colors",title:b?"隐藏":"显示",children:b?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),e.jsx("button",{onClick:()=>N(!0),className:"w-8 h-8 flex items-center justify-center rounded-lg text-[#8b949e] hover:text-[#f0f6fc] hover:bg-[#21262d] transition-colors",title:"编辑",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:B,disabled:s,className:"w-8 h-8 flex items-center justify-center rounded-lg text-[#8b949e] hover:text-[#f85149] hover:bg-[#f85149]/10 transition-colors disabled:opacity-50",title:"删除",children:s?e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}):e.jsxs("div",{className:"flex gap-2 h-full",children:[e.jsx("input",{type:"password",value:f,onChange:c=>w(c.target.value),onKeyDown:c=>{c.key==="Enter"&&f.trim()&&D(),c.key==="Escape"&&K()},placeholder:"请输入 API Key",autoFocus:r,className:"flex-1 px-3 h-full bg-[#161b22] border border-[#30363d] rounded-lg text-[#f0f6fc] placeholder-[#484f58] focus:outline-none focus:border-[#58a6ff]"}),e.jsx("button",{onClick:D,disabled:y||!f.trim(),className:`
                px-4 h-full rounded-lg font-medium text-sm transition-all duration-200 shrink-0
                ${y||!f.trim()?"bg-[#21262d] text-[#484f58] cursor-not-allowed":"bg-[#238636] text-white hover:bg-[#2ea043]"}
              `,children:y?"保存中...":"保存"}),r&&e.jsx("button",{onClick:K,className:"px-4 h-full rounded-lg font-medium text-sm transition-all duration-200 bg-[#21262d] text-[#8b949e] hover:text-[#f0f6fc] hover:bg-[#30363d]",children:"取消"})]})}),z&&S&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-[#30363d]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-[#8b949e]",children:"接入点 ID"}),I&&!n?e.jsx("span",{className:"text-xs text-emerald-400",children:"✓ 已配置"}):e.jsx("span",{className:"text-xs text-yellow-400",children:"⚠ 需配置"})]}),e.jsx("a",{href:"https://console.volcengine.com/ark/region:ark+cn-beijing/endpoint",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-[#58a6ff] hover:underline",children:"创建接入点 →"})]}),e.jsx("p",{className:"text-xs text-[#484f58] mb-3",children:"需要在火山方舟控制台创建推理接入点，获取 ep-xxxxx 格式的 ID"}),e.jsx("div",{className:"h-10",children:I&&!n?e.jsxs("div",{className:"flex items-center gap-3 h-full",children:[e.jsx("div",{className:"flex-1 px-3 h-full flex items-center bg-[#161b22] border border-[#30363d] rounded-lg font-mono text-sm text-[#8b949e]",children:e.jsx("span",{className:"whitespace-nowrap",children:j})}),e.jsx("button",{onClick:()=>t(!0),className:"w-8 h-8 flex items-center justify-center rounded-lg text-[#8b949e] hover:text-[#f0f6fc] hover:bg-[#21262d] transition-colors",title:"编辑",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]}):e.jsxs("div",{className:"flex gap-2 h-full",children:[e.jsx("input",{type:"text",value:u,onChange:c=>h(c.target.value),onKeyDown:c=>{c.key==="Enter"&&u.trim()&&P(),c.key==="Escape"&&V()},placeholder:"ep-xxxxx",autoFocus:n,className:"flex-1 px-3 h-full bg-[#161b22] border border-[#30363d] rounded-lg text-[#f0f6fc] placeholder-[#484f58] focus:outline-none focus:border-[#58a6ff] font-mono"}),e.jsx("button",{onClick:P,disabled:m||!u.trim(),className:`
                    px-4 h-full rounded-lg font-medium text-sm transition-all duration-200 shrink-0
                    ${m||!u.trim()?"bg-[#21262d] text-[#484f58] cursor-not-allowed":"bg-[#238636] text-white hover:bg-[#2ea043]"}
                  `,children:m?"保存中...":"保存"}),n&&e.jsx("button",{onClick:V,className:"px-4 h-full rounded-lg font-medium text-sm transition-all duration-200 bg-[#21262d] text-[#8b949e] hover:text-[#f0f6fc] hover:bg-[#30363d]",children:"取消"})]})})]})]})}function ee(){const[i,o]=d.useState(null),{data:x,loading:g}=W(O),{data:j,loading:C,refresh:p}=W(F),v=(x==null?void 0:x.models)||[],r=j||{defaultModel:null,apiKeys:{siliconflow:null,deepseek:null,openai:null,doubao:null}},N=(g||C)&&!x&&!j,b=s=>s.startsWith("siliconflow/")?"siliconflow":s.startsWith("deepseek/")?"deepseek":s.startsWith("doubao/")?"doubao":"openai",E=s=>s==="doubao"?!!r.apiKeys[s]&&!!r.doubaoEndpoint:!!r.apiKeys[s],f=async(s,a)=>{var n;try{await L({apiKeys:{[s]:a}}),await p(),l.success(`${(n=A.find(t=>t.key===s))==null?void 0:n.name} API Key 保存成功`)}catch(t){throw l.error(t instanceof Error?t.message:"保存失败"),t}},w=async s=>{var a;try{await H(s),await p(),l.success(`${(a=A.find(n=>n.key===s))==null?void 0:a.name} API Key 已删除`)}catch(n){throw l.error(n instanceof Error?n.message:"删除失败"),n}},y=async s=>{try{await L({doubaoEndpoint:s}),await p(),l.success("豆包接入点 ID 保存成功")}catch(a){throw l.error(a instanceof Error?a.message:"保存失败"),a}},k=async s=>{var n;if(s===r.defaultModel)return;const a=((n=v.find(t=>t.id===s))==null?void 0:n.name)||s;o(s);try{await L({defaultModel:s}),await p(),l.success(`默认模型已切换到: ${a}`)}catch(t){l.error(t instanceof Error?t.message:"切换失败")}finally{o(null)}};return N?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx("div",{className:"text-[#8b949e]",children:"加载中..."})}):e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("header",{className:"h-14 flex items-center px-6 bg-[#161b22] border-b border-[#30363d] shrink-0",children:e.jsx("h2",{className:"text-lg font-semibold text-[#f0f6fc]",children:"模型与 API Key"})}),e.jsx("main",{className:"flex-1 overflow-auto p-6",children:e.jsxs("div",{className:"max-w-3xl space-y-8",children:[e.jsxs("section",{className:"bg-[#161b22] rounded-lg border border-[#30363d] p-6",children:[e.jsx("h3",{className:"text-base font-semibold text-[#f0f6fc] mb-2",children:"API Keys"}),e.jsx("p",{className:"text-sm text-[#8b949e] mb-6",children:"配置各平台的 API Key 以启用对应的模型。"}),e.jsx("div",{className:"space-y-4",children:A.map(({key:s,name:a,url:n})=>e.jsx(G,{platform:s,name:a,url:n,apiKey:r.apiKeys[s],endpointId:s==="doubao"?r.doubaoEndpoint:void 0,onSave:t=>f(s,t),onDelete:()=>w(s),onSaveEndpoint:s==="doubao"?y:void 0},s))})]}),e.jsxs("section",{className:"bg-[#161b22] rounded-lg border border-[#30363d] p-6",children:[e.jsx("h3",{className:"text-base font-semibold text-[#f0f6fc] mb-2",children:"默认模型"}),e.jsx("p",{className:"text-sm text-[#8b949e] mb-6",children:"点击选择生成周报时使用的默认模型，选择后立即生效。"}),e.jsx("div",{className:"space-y-6",children:["doubao","deepseek","openai","siliconflow"].map(s=>{const a=v.filter(t=>b(t.id)===s);if(a.length===0)return null;const n={doubao:"火山方舟（豆包）",deepseek:"DeepSeek",openai:"OpenAI",siliconflow:"硅基流动（免费）"};return e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-[#8b949e] mb-3 flex items-center gap-2",children:[e.jsx($,{platform:s,className:"w-4 h-4"}),e.jsx("span",{children:n[s]})]}),e.jsx("div",{className:"grid gap-3",children:a.map(t=>{const u=E(s),h=r.defaultModel===t.id,m=i===t.id;return e.jsxs("button",{onClick:()=>k(t.id),disabled:m||h,className:`
                              w-full p-4 rounded-lg border text-left transition-all duration-200 relative
                              ${h?"bg-blue-500/10 border-blue-500/50":"bg-[#0d1117] border-[#30363d] hover:border-[#484f58]"}
                              ${m?"opacity-70":""}
                            `,children:[m&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#0d1117]/50 rounded-lg",children:e.jsx("span",{className:"text-sm text-[#8b949e]",children:"切换中..."})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-[#f0f6fc] flex items-center gap-2",children:[t.name,t.isFree&&e.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-400",children:"免费"}),h&&e.jsx("span",{className:"text-xs text-blue-400",children:"● 当前默认"})]}),e.jsx("div",{className:"text-sm text-[#8b949e] mt-1",children:t.description}),e.jsx("div",{className:"text-xs text-[#484f58] mt-1",children:t.id})]}),e.jsx("div",{className:"text-right",children:u?e.jsx("span",{className:"text-xs text-emerald-400",children:"可用"}):s==="doubao"?e.jsx("span",{className:"text-xs text-yellow-400",children:r.apiKeys[s]?"需配置接入点":"需配置 Key"}):e.jsx("span",{className:"text-xs text-yellow-400",children:"需配置 Key"})})]})]},t.id)})})]},s)})})]})]})})]})}export{ee as default};
